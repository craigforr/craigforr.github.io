<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Convert Times Between Time Zones with PowerShell | Craig Forrester</title><meta name=keywords content="powershell,time"><meta name=description content="Convert Time for different World Time Zone

            
    
      
        Last Revision: 2025-07-12
      
    If you work in a multinational organization like me or you have loved ones or friends who live in other parts of the country or world, then you have, no doubt, found yourself needing to convert time from one time zone to another.  In this post, I&rsquo;m going to show you how to do this really easily in PowerShell."><meta name=author content><link rel=canonical href=https://www.craigforrester.com/posts/convert-times-between-time-zones-with-powershell/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://www.craigforrester.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.craigforrester.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.craigforrester.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.craigforrester.com/apple-touch-icon.png><link rel=mask-icon href=https://www.craigforrester.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.craigforrester.com/posts/convert-times-between-time-zones-with-powershell/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://www.craigforrester.com/posts/convert-times-between-time-zones-with-powershell/"><meta property="og:site_name" content="Craig Forrester"><meta property="og:title" content="Convert Times Between Time Zones with PowerShell"><meta property="og:description" content="Convert Time for different World Time Zone Last Revision: 2025-07-12 If you work in a multinational organization like me or you have loved ones or friends who live in other parts of the country or world, then you have, no doubt, found yourself needing to convert time from one time zone to another. In this post, I‚Äôm going to show you how to do this really easily in PowerShell."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-04-25T17:00:00-05:00"><meta property="article:modified_time" content="2018-04-25T17:00:00-05:00"><meta property="article:tag" content="Powershell"><meta property="article:tag" content="Time"><meta property="og:see_also" content="https://www.craigforrester.com/posts/display-dates-and-times-with-powershell/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Convert Times Between Time Zones with PowerShell"><meta name=twitter:description content="Convert Time for different World Time Zone

            
    
      
        Last Revision: 2025-07-12
      
    If you work in a multinational organization like me or you have loved ones or friends who live in other parts of the country or world, then you have, no doubt, found yourself needing to convert time from one time zone to another.  In this post, I&rsquo;m going to show you how to do this really easily in PowerShell."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.craigforrester.com/posts/"},{"@type":"ListItem","position":2,"name":"Convert Times Between Time Zones with PowerShell","item":"https://www.craigforrester.com/posts/convert-times-between-time-zones-with-powershell/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Convert Times Between Time Zones with PowerShell","name":"Convert Times Between Time Zones with PowerShell","description":"Convert Time for different World Time Zone Last Revision: 2025-07-12 If you work in a multinational organization like me or you have loved ones or friends who live in other parts of the country or world, then you have, no doubt, found yourself needing to convert time from one time zone to another. In this post, I\u0026rsquo;m going to show you how to do this really easily in PowerShell.\n","keywords":["powershell","time"],"articleBody":"Convert Time for different World Time Zone Last Revision: 2025-07-12 If you work in a multinational organization like me or you have loved ones or friends who live in other parts of the country or world, then you have, no doubt, found yourself needing to convert time from one time zone to another. In this post, I‚Äôm going to show you how to do this really easily in PowerShell.\nTL;DR In a hurry? Here‚Äôs how to convert the current date and time from the local time zone to another one:\n# Convert the Local Date and Time to Greenwich Standard [System.TimeZoneInfo]::ConvertTimeBySystemTimeZoneId( ` (Get-Date), 'Greenwich Standard Time') Where we have ‚ÄòGreenwich Standard Time‚Äô here, you can put any time zone you wish and get the current time in that time zone (Note, too, that I have used the backtick (`) to split this into two lines in order to make it easier to read, which you do not have to do).\nWe are essentially providing two date and time objects ‚Äî one to convert from, the other to convert to:\n# $convert_from and $to here must be PowerShell DateTime objects [System.TimeZoneInfo]::ConvertTimeBySystemTimeZoneId( $convert_from , $to ) Picking a Date and Time Breaking it down, you first want to get the time to convert from, using the Get-Date command. We‚Äôll call this the ‚Äúinput time‚Äù from now on.\nGet-Date What if you want to use a different time then the current time though? Well, the solution is as simple as giving Get-Date the time you want to use:\nGet-Date \"2018-12-25 00:00\" Choosing a Time Zone Next, you want to determine the name of the time zone you are converting that input time to. In my first example, I used ‚ÄúGreenwich Standard Time‚Äù, but what about other time zones? And how did I know that ‚ÄúGreenwich Standard Time‚Äù was a valid time zone anyway?\nTo list valid time zones, we can access the .Net TimeZoneInfo Class, as follows:\n[System.TimeZoneInfo]::GetSystemTimeZones( ) This will output a list of time zones as objects. Here is an example:\nId : India Standard Time\rDisplayName : (UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi\rStandardName : India Standard Time\rDaylightName : India Daylight Time\rBaseUtcOffset : 05:30:00\rSupportsDaylightSavingTime : False Using this information, we can convert from the input time to whatever time zone we choose by using TimeZoneInfo.ConvertTimeBySystemTimeZoneId Method:\n[System.TimeZoneInfo]::ConvertTimeBySystemTimeZoneId( ` (Get-Date), 'India Standard Time') # # Example Output: # # Tuesday, April 25, 2018 4:30:00 AM ConvertTimeBySystemTimeZoneId uses the local system‚Äôs time zone to determine the input time zone, since the output object of Get-Date does not have the Kind property and the default is Unspecified. So, if we want to convert from a time zone different from the one our system is in, we need to do a bit more work‚Ä¶\nConverting Between Two Different Time Zones First, we need time zone information for both the source and destination. We‚Äôll assign both of these to variable that we can use later:\n# Assign India time zone info to a variable $intz = [System.TimeZoneInfo]::GetSystemTimeZones() | Where-Object { $_.Id -match \"India Standard\" } # Assign Eastern Australia time zone info to a variable $autz = [System.TimeZoneInfo]::GetSystemTimeZones() | Where-Object { $_.Id -match \"AUS Eastern\" } Next we need the date and time we would like to convert. We will use a string here, because we will be specifying the input time zone using the variables we just created:\n# This will work $time_to_convert = \"2018-12-25 00:00\" # This will also work $time_to_convert = ((Get-Date).ToString('yyyy-MM-ddTHH:mm:ss')) # This will NOT work, because the string contains the local time zone $time_to_convert = ((Get-Date).ToString('yyyy-MM-ddTHH:mm:ssz')) # ^ # Note the `z` here tells the ToString method to include the # system's time zone offset, which will confuse ConvertTime() # See the example, below... Once we have an input time, input time zone, and output time zone, all that remains is to piece them all together in a call to ConvertTime():\n[System.TimeZoneInfo]::ConvertTime( ` \"2018-12-25 00:00\", $intz, $autz) # Output: # # Tuesday, December 25, 2018 5:30:00 AM # Remember earlier when we said adding z to the ToString formatting wouldn‚Äôt work? Here‚Äôs the error you will get if you do:\n# This will NOT work, because the string contains the local time zone $time_to_convert = '2018-12-25T00:00:00-4' [System.TimeZoneInfo]::ConvertTime($time_to_convert, $intz, $autz) # # Output: # # Exception calling \"ConvertTime\" with \"3\" argument(s): \"The conversion could not be completed because the supplied DateTime did not have the Kind property set correctly. # For example, when the Kind property is DateTimeKind.Local, the source time zone must be TimeZoneInfo.Local. # Parameter name: sourceTimeZone\" # At line:1 char:1 # + [System.TimeZoneInfo]::ConvertTime( ` # + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ # + CategoryInfo : NotSpecified: (:) [], MethodInvocationException # + FullyQualifiedErrorId : ArgumentException # # Here's the working example: $time_to_convert = '2018-12-25T00:00:00' [System.TimeZoneInfo]::ConvertTime($time_to_convert, $intz, $autz) # # Output: # # Tuesday, December 25, 2018 5:30:00 AM In the next post, we‚Äôll cover how to put all this together into a time zone converter that we can use to easily convert dates and times whenever we have the need.\nAdditional Reading Documentation: TimeZoneInfo Class Documentation: TimeZoneInfo.ConvertTimeBySystemTimeZoneId Method Documentation: DateTime.Kind Property ","wordCount":"851","inLanguage":"en","datePublished":"2018-04-25T17:00:00-05:00","dateModified":"2018-04-25T17:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.craigforrester.com/posts/convert-times-between-time-zones-with-powershell/"},"publisher":{"@type":"Organization","name":"Craig Forrester","logo":{"@type":"ImageObject","url":"https://www.craigforrester.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.craigforrester.com/ accesskey=h title="Craig Forrester (Alt + H)">Craig Forrester</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.craigforrester.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://www.craigforrester.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://www.craigforrester.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.craigforrester.com/series/ title=Series><span>Series</span></a></li><li><a href=https://www.craigforrester.com/search/ title="üîç Search"><span>üîç Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Convert Times Between Time Zones with PowerShell</h1><div class=post-meta><span title='2018-04-25 17:00:00 -0500 -0500'>April 25, 2018</span></div></header><div class=post-content><h2 id=convert-time-for-different-world-time-zone>Convert Time for different World Time Zone<a hidden class=anchor aria-hidden=true href=#convert-time-for-different-world-time-zone>#</a></h2><link rel=stylesheet href=/css/vendors/admonitions.4fd9a0b8ec8899f2ca952048d255a569f433f77dfb3f52f5bc87e7d65cdce449.css integrity="sha256-T9mguOyImfLKlSBI0lWlafQz9337P1L1vIfn1lzc5Ek=" crossorigin=anonymous><div class="admonition note"><div class=admonition-header><svg viewBox="0 0 576 512"><path d="M0 64C0 28.7 28.7.0 64 0H224v128c0 17.7 14.3 32 32 32h128v125.7l-86.8 86.8c-10.3 10.3-17.5 23.1-21 37.2l-18.7 74.9c-2.3 9.2-1.8 18.8 1.3 27.5L64 512c-35.3.0-64-28.7-64-64V64zm384 64H256V0L384 128zM549.8 235.7l14.4 14.4c15.6 15.6 15.6 40.9.0 56.6l-29.4 29.4-71-71 29.4-29.4c15.6-15.6 40.9-15.6 56.6.0zM311.9 417 441.1 287.8l71 71L382.9 487.9c-4.1 4.1-9.2 7-14.9 8.4l-60.1 15c-5.5 1.4-11.2-.2-15.2-4.2s-5.6-9.7-4.2-15.2l15-60.1c1.4-5.6 4.3-10.8 8.4-14.9z"/></svg>
<span>Last Revision: 2025-07-12</span></div></div><p>If you work in a multinational organization like me or you have loved ones or friends who live in other parts of the country or world, then you have, no doubt, found yourself needing to convert time from one time zone to another. In this post, I&rsquo;m going to show you how to do this really easily in PowerShell.</p><h3 id=tldr>TL;DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h3><p>In a hurry? Here&rsquo;s how to convert the current date and time from the local time zone to another one:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Convert the Local Date and Time to Greenwich Standard</span>
</span></span><span style=display:flex><span>[<span style=color:#66d9ef>System.TimeZoneInfo</span>]::ConvertTimeBySystemTimeZoneId( `
</span></span><span style=display:flex><span>    (Get-Date), <span style=color:#e6db74>&#39;Greenwich Standard Time&#39;</span>)
</span></span></code></pre></div><p>Where we have &lsquo;Greenwich Standard Time&rsquo; here, you can put any time zone you wish and get the current time in that time zone (Note, too, that I have used the backtick (`) to split this into two lines in order to make it easier to read, which you do not have to do).</p><p>We are essentially providing two date and time objects &mdash; one to convert <em>from</em>, the other to convert <em>to:</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># $convert_from and $to here must be PowerShell DateTime objects</span>
</span></span><span style=display:flex><span>[<span style=color:#66d9ef>System.TimeZoneInfo</span>]::ConvertTimeBySystemTimeZoneId( $convert_from , $to )
</span></span></code></pre></div><h3 id=picking-a-date-and-time>Picking a Date and Time<a hidden class=anchor aria-hidden=true href=#picking-a-date-and-time>#</a></h3><p>Breaking it down, you first want to get the time to convert <em>from</em>, using the <code>Get-Date</code> command. We&rsquo;ll call this the &ldquo;input time&rdquo; from now on.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-Date
</span></span></code></pre></div><p>What if you want to use a different time then the current time though? Well, the solution is as simple as giving <code>Get-Date</code> the time you want to use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Get-Date <span style=color:#e6db74>&#34;2018-12-25 00:00&#34;</span>
</span></span></code></pre></div><h3 id=choosing-a-time-zone>Choosing a Time Zone<a hidden class=anchor aria-hidden=true href=#choosing-a-time-zone>#</a></h3><p>Next, you want to determine the name of the time zone you are converting that input time <em>to</em>. In my first example, I used &ldquo;Greenwich Standard Time&rdquo;, but what about other time zones? And how did I know that &ldquo;Greenwich Standard Time&rdquo; was a valid time zone anyway?</p><p>To list valid time zones, we can access the .Net <a href=https://learn.microsoft.com/en-us/dotnet/api/system.timezoneinfo title="TimeZoneInfo Class">TimeZoneInfo Class</a>, as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>[<span style=color:#66d9ef>System.TimeZoneInfo</span>]::GetSystemTimeZones( )
</span></span></code></pre></div><p>This will output a list of time zones as objects. Here is an example:</p><pre tabindex=0><code class=language-nohighlight data-lang=nohighlight>Id                         : India Standard Time
DisplayName                : (UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi
StandardName               : India Standard Time
DaylightName               : India Daylight Time
BaseUtcOffset              : 05:30:00
SupportsDaylightSavingTime : False
</code></pre><p>Using this information, we can convert from the input time to whatever time zone we choose by using <a href=https://learn.microsoft.com/en-us/dotnet/api/system.timezoneinfo.converttimebysystemtimezoneid title="TimeZoneInfo.ConvertTimeBySystemTimeZoneId Method">TimeZoneInfo.ConvertTimeBySystemTimeZoneId Method</a>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>[<span style=color:#66d9ef>System.TimeZoneInfo</span>]::ConvertTimeBySystemTimeZoneId( `
</span></span><span style=display:flex><span>    (Get-Date), <span style=color:#e6db74>&#39;India Standard Time&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Example Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Tuesday, April 25, 2018 4:30:00 AM</span>
</span></span></code></pre></div><p><code>ConvertTimeBySystemTimeZoneId</code> uses the local system&rsquo;s time zone to determine the input time zone, since the output object of <code>Get-Date</code> does not have the <code>Kind</code> property and <a href=https://learn.microsoft.com/en-us/dotnet/api/system.datetime.kind title="DateTime.Kind Property">the default is Unspecified</a>. So, if we want to convert from a time zone different from the one our system is in, we need to do a bit more work&mldr;</p><h3 id=converting-between-two-different-time-zones>Converting Between Two Different Time Zones<a hidden class=anchor aria-hidden=true href=#converting-between-two-different-time-zones>#</a></h3><p>First, we need time zone information for both the source and destination. We&rsquo;ll assign both of these to variable that we can use later:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Assign India time zone info to a variable</span>
</span></span><span style=display:flex><span>$intz = [<span style=color:#66d9ef>System.TimeZoneInfo</span>]::GetSystemTimeZones() | 
</span></span><span style=display:flex><span>    Where-Object { $_.Id <span style=color:#f92672>-match</span> <span style=color:#e6db74>&#34;India Standard&#34;</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Assign Eastern Australia time zone info to a variable</span>
</span></span><span style=display:flex><span>$autz = [<span style=color:#66d9ef>System.TimeZoneInfo</span>]::GetSystemTimeZones() |
</span></span><span style=display:flex><span>    Where-Object { $_.Id <span style=color:#f92672>-match</span> <span style=color:#e6db74>&#34;AUS Eastern&#34;</span> }
</span></span></code></pre></div><p>Next we need the date and time we would like to convert. We will use a string here, because we will be specifying the input time zone using the variables we just created:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># This will work</span>
</span></span><span style=display:flex><span>$time_to_convert = <span style=color:#e6db74>&#34;2018-12-25 00:00&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This will also work</span>
</span></span><span style=display:flex><span>$time_to_convert = ((Get-Date).ToString(<span style=color:#e6db74>&#39;yyyy-MM-ddTHH:mm:ss&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This will NOT work, because the string contains the local time zone</span>
</span></span><span style=display:flex><span>$time_to_convert = ((Get-Date).ToString(<span style=color:#e6db74>&#39;yyyy-MM-ddTHH:mm:ssz&#39;</span>))
</span></span><span style=display:flex><span><span style=color:#75715e>#                                                           ^</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Note the `z` here tells the ToString method to include the </span>
</span></span><span style=display:flex><span><span style=color:#75715e># system&#39;s time zone offset, which will confuse ConvertTime()</span>
</span></span><span style=display:flex><span><span style=color:#75715e># See the example, below...</span>
</span></span></code></pre></div><p>Once we have an input time, input time zone, and output time zone, all that remains is to piece them all together in a call to <code>ConvertTime()</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>[<span style=color:#66d9ef>System.TimeZoneInfo</span>]::ConvertTime( `
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;2018-12-25 00:00&#34;</span>, $intz, $autz)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Tuesday, December 25, 2018 5:30:00 AM </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span></code></pre></div><p>Remember earlier when we said adding <code>z</code> to the <code>ToString</code> formatting wouldn&rsquo;t work? Here&rsquo;s the error you will get if you do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># This will NOT work, because the string contains the local time zone</span>
</span></span><span style=display:flex><span>$time_to_convert = <span style=color:#e6db74>&#39;2018-12-25T00:00:00-4&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#66d9ef>System.TimeZoneInfo</span>]::ConvertTime($time_to_convert, $intz, $autz)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Exception calling &#34;ConvertTime&#34; with &#34;3&#34; argument(s): &#34;The conversion could not be completed because the supplied DateTime did not have the Kind property set correctly.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># For example, when the Kind property is DateTimeKind.Local, the source time zone must be TimeZoneInfo.Local.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Parameter name: sourceTimeZone&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># At line:1 char:1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># + [System.TimeZoneInfo]::ConvertTime( `</span>
</span></span><span style=display:flex><span><span style=color:#75715e># + ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#     + FullyQualifiedErrorId : ArgumentException</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Here&#39;s the working example:</span>
</span></span><span style=display:flex><span>$time_to_convert = <span style=color:#e6db74>&#39;2018-12-25T00:00:00&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#66d9ef>System.TimeZoneInfo</span>]::ConvertTime($time_to_convert, $intz, $autz)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Output:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Tuesday, December 25, 2018 5:30:00 AM</span>
</span></span></code></pre></div><p>In the next post, we&rsquo;ll cover how to put all this together into a time zone converter that we can use to easily convert dates and times whenever we have the need.</p><h2 id=additional-reading>Additional Reading<a hidden class=anchor aria-hidden=true href=#additional-reading>#</a></h2><ul><li>Documentation: <a href=https://learn.microsoft.com/en-us/dotnet/api/system.timezoneinfo title="TimeZoneInfo Class">TimeZoneInfo Class</a></li><li>Documentation: <a href=https://learn.microsoft.com/en-us/dotnet/api/system.timezoneinfo.converttimebysystemtimezoneid title="TimeZoneInfo.ConvertTimeBySystemTimeZoneId Method">TimeZoneInfo.ConvertTimeBySystemTimeZoneId Method</a></li><li>Documentation: <a href=https://learn.microsoft.com/en-us/dotnet/api/system.datetime.kind title="DateTime.Kind Property">DateTime.Kind Property</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.craigforrester.com/tags/powershell/>Powershell</a></li><li><a href=https://www.craigforrester.com/tags/time/>Time</a></li></ul></footer></article></main><footer class=footer><span>¬© 1999-2025 Craig Forrester</span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>